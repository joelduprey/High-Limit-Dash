<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Race Grid</title>
</head>
<body>
    <h1>Race Grid Setup</h1>
    <form onsubmit="saveFormData(); return false;">
        <!-- Form for input -->
        <label for="fanQuestion">Fan Question:</label>
        <input type="text" id="fanQuestion"><br>
        <label for="fanName">Fan Name:</label>
        <input type="text" id="fanName"><br>
        <label for="fanHometown">Fan Hometown:</label>
        <input type="text" id="fanHometown"><br>
        
        <!-- Driver inputs -->
        <h3>Driver Information</h3>
        <div id="driverInputs">
            <div>
                <label for="driver1">Driver 1:</label>
                <input type="text" id="driver1">
                <label for="time1">Time:</label>
                <input type="text" id="time1">
                <label for="spin1">Spin:</label>
                <input type="text" id="spin1">
            </div>
            <!-- Repeat similar blocks for drivers 2 to 8 -->
        </div>
        
        <button type="submit">Save</button>
    </form>

    <h3>Starting Grid</h3>
    <table border="1">
        <thead>
            <tr>
                <th>Position</th>
                <th>Driver</th>
                <th>Time</th>
                <th>Spin</th>
            </tr>
        </thead>
        <tbody id="startingOrder">
            <!-- Table rows will be added dynamically -->
        </tbody>
    </table>

    <button onclick="resetForm()">Reset</button>

    <script>
        // Save form data in localStorage
        function saveFormData() {
            const data = {
                fanQuestion: document.getElementById('fanQuestion').value,
                fanName: document.getElementById('fanName').value,
                fanHometown: document.getElementById('fanHometown').value,
                driver1: document.getElementById('driver1').value,
                driver2: document.getElementById('driver2').value,
                driver3: document.getElementById('driver3').value,
                driver4: document.getElementById('driver4').value,
                driver5: document.getElementById('driver5').value,
                driver6: document.getElementById('driver6').value,
                driver7: document.getElementById('driver7').value,
                driver8: document.getElementById('driver8').value,
                time1: document.getElementById('time1').value,
                time2: document.getElementById('time2').value,
                time3: document.getElementById('time3').value,
                time4: document.getElementById('time4').value,
                time5: document.getElementById('time5').value,
                time6: document.getElementById('time6').value,
                time7: document.getElementById('time7').value,
                time8: document.getElementById('time8').value,
                spin1: document.getElementById('spin1').value,
                spin2: document.getElementById('spin2').value,
                spin3: document.getElementById('spin3').value,
                spin4: document.getElementById('spin4').value,
                spin5: document.getElementById('spin5').value,
                spin6: document.getElementById('spin6').value,
                spin7: document.getElementById('spin7').value,
                spin8: document.getElementById('spin8').value,
            };
            console.log('Saving data:', data); // Debugging line
            localStorage.setItem('formData', JSON.stringify(data));
            updateGrid(); // Update the table after saving
        }

        // Load form data from localStorage
        function loadFormData() {
            const savedData = JSON.parse(localStorage.getItem('formData'));
            console.log('Loaded data:', savedData); // Debugging line
            if (savedData) {
                document.getElementById('fanQuestion').value = savedData.fanQuestion || '';
                document.getElementById('fanName').value = savedData.fanName || '';
                document.getElementById('fanHometown').value = savedData.fanHometown || '';
                document.getElementById('driver1').value = savedData.driver1 || '';
                document.getElementById('driver2').value = savedData.driver2 || '';
                document.getElementById('driver3').value = savedData.driver3 || '';
                document.getElementById('driver4').value = savedData.driver4 || '';
                document.getElementById('driver5').value = savedData.driver5 || '';
                document.getElementById('driver6').value = savedData.driver6 || '';
                document.getElementById('driver7').value = savedData.driver7 || '';
                document.getElementById('driver8').value = savedData.driver8 || '';
                document.getElementById('time1').value = savedData.time1 || '';
                document.getElementById('time2').value = savedData.time2 || '';
                document.getElementById('time3').value = savedData.time3 || '';
                document.getElementById('time4').value = savedData.time4 || '';
                document.getElementById('time5').value = savedData.time5 || '';
                document.getElementById('time6').value = savedData.time6 || '';
                document.getElementById('time7').value = savedData.time7 || '';
                document.getElementById('time8').value = savedData.time8 || '';
                document.getElementById('spin1').value = savedData.spin1 || '';
                document.getElementById('spin2').value = savedData.spin2 || '';
                document.getElementById('spin3').value = savedData.spin3 || '';
                document.getElementById('spin4').value = savedData.spin4 || '';
                document.getElementById('spin5').value = savedData.spin5 || '';
                document.getElementById('spin6').value = savedData.spin6 || '';
                document.getElementById('spin7').value = savedData.spin7 || '';
                document.getElementById('spin8').value = savedData.spin8 || '';
                updateGrid(); // Update grid after loading data
            }
        }

        // Update the starting order table
        function updateGrid() {
            const drivers = [];
            for (let i = 1; i <= 8; i++) {
                const driver = document.getElementById(`driver${i}`).value;
                const time = document.getElementById(`time${i}`).value;
                const spin = document.getElementById(`spin${i}`).value;
                if (driver && time && spin) {
                    drivers.push({ driver, time, spin });
                }
            }
            console.log('Drivers:', drivers); // Debugging line

            // Sort by spin number
            drivers.sort((a, b) => a.spin - b.spin);

            // Populate the table
            const tableBody = document.getElementById("startingOrder");
            tableBody.innerHTML = ''; // Clear existing rows
            drivers.forEach((driver, index) => {
                const row = document.createElement("tr");
                const rowNumber = document.createElement("td");
                rowNumber.textContent = index + 1; // Row number
                row.appendChild(rowNumber);

                const driverName = document.createElement("td");
                driverName.textContent = driver.driver;
                row.appendChild(driverName);

                const driverTime = document.createElement("td");
                driverTime.textContent = driver.time;
                row.appendChild(driverTime);

                const driverSpin = document.createElement("td");
                driverSpin.textContent = driver.spin;
                row.appendChild(driverSpin);

                tableBody.appendChild(row);
            });
        }

        // Reset form data and table
        function resetForm() {
            localStorage.removeItem('formData'); // Remove saved data
            loadFormData(); // Reload empty data
            document.getElementById('startingOrder').innerHTML = ''; // Clear table
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', loadFormData);
    </script>
</body>
</html>
